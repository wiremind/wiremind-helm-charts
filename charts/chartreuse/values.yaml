# Default values for chartreuse.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

image:
  ## Change me to a real image from a tag containing chartreuse python package and your migration code
  repository: overrideme
  ## Change me to a real image from a tag
  tag: latest
  pullPolicy: IfNotPresent
  ## Note: singular, this is a string and allows a single secret
  pullSecret: ""

## Wether to run schema upgrade before deployment or after deployment
## Note that in case of initial deployment ("install" in helm dialect), chartreuse will be run during deployment as a normal job
upgradeBeforeDeployment: false

## Whether or not to scale down deployments with ExpectedDeploymentScale before migrating (if migration is needed)
stopPods: true

## Additional environment variables injected within chartreuse Pods
additionalEnvironmentVariables: {}

# Extra volumes
extraVolumes: []
# - name: thevolume
#   emptyDir:
#     medium: Memory

## Extra volumes to mount
extraVolumeMounts: []
# - name: thevolume
#   mountPath: /tmp/something

## In the case of having multiple upgradeJobs of multiple Chartreuses running, this will allow
## to control the order of their execution, they are executed in weighted order.
## Make sure the weights are > 0
upgradeJobWeight: "1"

alembic:
  enabled: true
  ## If you want to use External Secrets Operator to fetch the database credentials
  externalSecrets:
    refreshInterval: "99999h"   # effectively disables refreshes
    storeRef:
      name: "my-cluster-secret-store"
      kind: ClusterSecretStore
  database_list:
    # postgresql:
    #   databaseType: postgresql
    #   dialect: postgresql
    #   port: 5432
    #   user: cache_user
    #   passwordRemoteRefKey: "my-dummy-postgresql-password-remote-ref-key"
    #   host: localhost
    #   database: cache_db
    #   isPatroniPostgresql: true
    # clickhouse:
    #   databaseType: clickhouse
    #   dialect: clickhouse
    #   user: user
    #   port: 8123
    #   passwordRemoteRefKey: "my-dummy-clickhouse-password-remote-ref-key"
    #   host: localhost
    #   database: db
    #   isPatroniPostgresql: false
  allowMigrationFromEmptyDatabase: true
  ## like "-x env_type=staging"
  additionalParameters: ""
  directoryPath: "/app/alembic"
  configPath: "alembic.ini"

## The entry point to use. Unless you want to re-use chartreuse as library in your code
## you have no reason to edit it.
entrypoint: "chartreuse-upgrade"

rbac:
  create: true

serviceAccount:
  create: true
  name:

priorityClassName: ""

resources: {}

nodeSelector: {}

tolerations: []

affinity: {}

podAnnotations: {}
